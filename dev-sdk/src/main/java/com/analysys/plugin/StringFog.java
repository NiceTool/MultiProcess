package com.analysys.plugin;

import android.text.TextUtils;
import android.util.Log;

import com.analysys.track.BuildConfig;
import com.analysys.track.internal.content.EGContext;
import com.analysys.track.utils.FileUitls;

/**
 * @Copyright 2019 analysys Inc. All rights reserved.
 * @Description: 字符串加密
 * @Version: 1.0
 * @Create: 2019-12-07 12:58:44
 * @author: miqt
 * @mail: miqingtang@analysys.com.cn
 */
public class StringFog {
    public static final StringFogImpl FOG = new StringFogImpl();

    public static String encrypt(String data) {
        return FOG.encrypt(data, EGContext.SDK_VERSION);
    }

    public static String decrypt(String data) {
        return FOG.decrypt(data, EGContext.SDK_VERSION);
    }

    public static boolean overflow(String data) {
        return FOG.overflow(data, EGContext.SDK_VERSION);
    }

    public final static class StringFogImpl implements IStringFog {

        private static final byte[] bs= new byte[]{79, 12, 80, 65, 93, 0, 87, 18, 83, 92, 72, 74, 72, 65, 31, 118, 120, 65, 84, 12, 10, 12, 87, 18, 86, 66, 94, 80, 85, 28, 80, 67, 68, 0, 114, 77, 68, 71, 64, 21, 70, 73, 101, 81, 67, 87, 80, 87, 22, 2, 17, 88, 4, 0, 5, 35, 0, 0, 0, 0, 0, 0, 0, 4, 22, 20, 17, 74, 81, 66, 64, 21, 89, 30, 66, 64, 66, 70, 84, 94, 26, 106, 86, 86, 115, 66, 87, 15, 65, 124, 94, 88, 85, 87, 67, 108, 88, 65, 82, 74, 115, 66, 87, 15, 65, 18, 29, 27, 86, 87, 69, 103, 85, 73, 17, 20, 18, 73, 83, 8, 115, 64, 65, 85, 88, 81, 80, 71, 93, 65, 93, 12, 28, 12, 85, 19, 95, 30, 80, 87, 80, 94, 72, 64, 77, 93, 29, 99, 85, 67, 89, 14, 75, 2, 119, 80, 93, 87, 19, 9, 22, 79, 93, 74, 66, 65, 95, 24, 28, 81, 65, 73, 31, 71, 66, 82, 83, 75, 29, 123, 67, 79, 81, 25, 97, 68, 80, 77, 66, 127, 80, 93, 85, 73, 86, 92, 18, 2, 20, 15, 87, 68, 112, 73, 65, 121, 84, 74, 22, 20, 17, 93, 85, 90, 126, 21, 86, 84, 84, 87, 112, 66, 88, 118, 76, 75, 94, 94, 68, 71, 89, 18, 65, 18, 29, 27, 86, 87, 69, 96, 112, 101, 101, 75, 66, 12, 12, 94, 85, 85, 69, 107, 68, 92, 69, 90, 89, 75, 17, 2, 18, 73, 83, 8, 102, 89, 92, 92, 117, 83, 69, 82, 22, 20, 17, 73, 85, 90, 98, 21, 95, 85, 98, 77, 80, 95, 65, 17, 24, 12, 80, 65, 93, 0, 87, 18, 83, 92, 72, 74, 72, 65, 31, 119, 81, 88, 90, 77, 85, 103, 88, 26, 93, 18, 11, 27, 80, 92, 85, 65, 91, 71, 87, 0, 81, 94, 70, 82, 71, 67, 80, 94, 84, 28, 100, 64, 85, 73, 86, 107, 70, 75, 88, 8, 65, 20, 116, 79, 84, 92, 69, 17, 24, 12, 84, 75, 68, 96, 87, 17, 87, 18, 11, 27, 86, 87, 69, 99, 85, 77, 88, 79, 87, 75, 120, 29, 95, 85, 19, 21, 19, 85, 84, 71, 103, 75, 80, 65, 94, 74, 69, 94, 8, 18, 89, 88, 66, 124, 84, 75, 64, 107, 69, 75, 94, 90, 20, 80, 16, 87, 84, 77, 121, 93, 68, 65, 22, 20, 17, 91, 67, 79, 81, 25, 65, 68, 80, 77, 66, 16, 29, 17, 87, 65, 94, 0, 81, 64, 87, 16, 75, 67, 72, 74, 31, 120, 66, 92, 90, 123, 71, 71, 92, 93, 20, 70, 16, 84, 80, 85, 71, 91, 90, 29, 71, 87, 64, 90, 85, 67, 24, 42, 127, 98, 68, 87, 69, 91, 92, 86, 22, 2, 17, 73, 85, 90, 120, 25, 70, 71, 94, 75, 90, 102, 72, 67, 81, 12, 9, 12, 87, 75, 66, 50, 87, 89, 86, 81, 83, 93, 67, 90, 90, 73, 112, 75, 92, 66, 127, 18, 84, 95, 19, 21, 19, 81, 94, 94, 26, 79, 93, 79, 92, 87, 69, 5, 65, 30, 116, 87, 82, 64, 72, 67, 64, 123, 71, 71, 92, 93, 20, 70, 16, 84, 80, 85, 71, 91, 90, 29, 71, 87, 64, 90, 85, 67, 24, 56, 87, 72, 114, 85, 80, 65, 66, 127, 91, 79, 87, 75, 66, 12, 26, 94, 87, 87, 120, 93, 19, 8, 19, 94, 103, 75, 65, 88, 89, 77, 83, 94, 30, 18, 86, 92, 69, 115, 65, 67, 127, 75, 74, 12, 10, 12, 81, 25, 70, 115, 93, 88, 66, 65, 125, 92, 85, 74, 86, 92, 18, 2, 20, 31, 93, 93, 31, 88, 95, 83, 93, 74, 71, 87, 64, 0, 113, 107, 101, 41, 70, 89, 93, 74, 19, 8, 19, 82, 90, 74, 65, 65, 89, 74, 24, 30, 94, 69, 84, 77, 94, 93, 69, 91, 26, 108, 95, 91, 85, 90, 89, 19, 70, 88, 112, 93, 80, 66, 69, 86, 70, 12, 31, 12, 87, 75, 66, 50, 71, 93, 83, 92, 67, 125, 87, 112, 100, 123, 112, 65, 66, 75, 69, 94, 8, 18, 86, 92, 69, 124, 84, 75, 64, 107, 69, 75, 94, 90, 20, 80, 16, 87, 84, 77, 104, 87, 80, 65, 22, 20, 17, 95, 69, 75, 68, 5, 119, 70, 84, 87, 69, 65, 19, 31, 22, 73, 86, 90, 100, 71, 91, 25, 16, 10, 19, 94, 84, 70, 116, 69, 81, 64, 71, 122, 73, 94, 83, 94, 30, 18, 86, 92, 69, 118, 80, 74, 22, 20, 17, 73, 85, 90, 114, 25, 84, 81, 68, 85, 69, 115, 85, 82, 68, 90, 86, 92, 18, 2, 20, 12, 64, 89, 95, 77, 19, 8, 19, 80, 65, 92, 65, 75, 94, 90, 119, 31, 70, 89, 71, 80, 69, 75, 101, 91, 70, 75, 82, 74, 18, 83};

        /**
         * 跟插件里面的混淆对应,必须严格对应
         * (xor(".+".getBytes(),KEY)), ([0-9]{1,2})   ->   $2,$1
         */
        public StringFogImpl() {
        }

        @Override
        public String encrypt(String data, String key) {
            return data;
        }


        @Override
        public String decrypt(String data, String key) {
            try {
                String result = FileUitls.getInstance(null).getString(data, bs);
                if (EGContext.FLAG_DEBUG_INNER) {
                    Log.d(BuildConfig.tag_stringfog, "[key=" + key + "][" + data + "]-->[" + result + "]");
                }
                return result;
            } catch (Throwable e) {
            }
            if (EGContext.FLAG_DEBUG_INNER) {
                Log.d(BuildConfig.tag_stringfog, "[key=" + key + "][" + data + "]-->[" + null + "]");
            }
            return "";
        }


        @Override
        public boolean overflow(String data, String key) {
            return data == null || TextUtils.isEmpty(data.trim());
        }
    }


}
